#!/usr/bin/env python3
"""
Auto-generated data cleansing script
Generated by HRIS Data Quality Agent
"""

import json
import re
from typing import Dict, List, Any

def clean_data(data: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
    """Apply automated data fixes."""
    
    cleaned_data = []
    
    for record in data:
        record = record.copy()  # Don't modify original
        record_id = record.get('employee_id', 'Unknown')
        
        # Apply fixes
        if record_id == 'EMP002':
            record['phone'] = '+1-555-0000'
            record['department'] = 'Engineering'
        if record_id == 'EMP004':
            record['email'] = '*@company.com'
            record['email'] = record.get('email', '').title()
            record['phone'] = '+1-555-0000'
            record['employment_status'] = 'Active'
        if record_id == 'EMP006':
            record['phone'] = '+1-555-0000'
        if record_id == 'EMP007':
            record['email'] = 'valid@domain.com'
            record['email'] = '*@company.com'
        if record_id == 'EMP008':
            record['first_name'] = 'Carlos'
            record['last_name'] = 'Rodriguez'
        if record_id == 'EMP009':
            record['email'] = '*@company.com'
        if record_id == 'EMP010':
        if record_id == 'EMP014':
            record['phone'] = '+1-555-0000'

        cleaned_data.append(record)
    
    return cleaned_data

if __name__ == '__main__':
    # Load data
    with open('employee_data.json', 'r') as f:
        data = json.load(f)
    
    # Clean data
    cleaned = clean_data(data)
    
    # Save cleaned data
    with open('employee_data_cleaned.json', 'w') as f:
        json.dump(cleaned, f, indent=2)
    
    print(f"Cleaned {len(cleaned)} records")
